{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Byte ChatApp</title>
  <link rel="stylesheet" href="{% static '/css/chatlist.css' %}" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
</head>
<body>

<section class="chat-page">
  <header class="chat-header">
    <a href="{% url "frontpage" %}">
        <i class="fa fa-arrow-left"></i>
    </a>
    <h2>Meet New Matches</h2>
  </header>

  <!-- Search bar -->
  <div class="search-bar">
    <i class="fa fa-search"></i>
    <input type="text" placeholder="Search Matches or Users" />
  </div>

  <!-- New Matches List -->
  <div class="chat-list" id="new-match-list">
    {% if new_matches %}
      {% for user in new_matches %}
      <a href="{% url 'chat_view' username=username contact=user.username %}" class="chat-item">
        <div class="chat-left">
          <img src="{{ user.profile_img.url }}" alt="{{ user.username }}">
          <div class="chat-info">
            <h4>{{ user.username|capfirst }}</h4>
            <p>{{ user.email }} | {{ user.phone_number }}</p>
          </div>
        </div>
      </a>
      {% endfor %}
    {% else %}
      <p style="text-align:center; margin-top:20px;">No new matches available</p>
    {% endif %}
  </div>

  <!-- Footer Navigation -->
  <nav class="footer-nav">
    <a href="{% url "frontpage" %}" class="nav-item">
      <i class="fa fa-comment-dots"></i>
      <span>Chat</span>
    </a>
    <a href="{% url 'newFriend' %}" class="nav-item active">
      <i class="fa fa-user-friends"></i>
      <span>Friends</span>
    </a>
    <a href="{% url 'profile' %}" class="nav-item">
      <i class="fa fa-user"></i>
      <span>Profile</span>
    </a>
    <a href="{% url 'logout' %}" class="nav-item">
      <i class="fa-solid fa-right-from-bracket"></i>
      <span>LogOut</span>
    </a>
  </nav>
</section>

<!-- Optional: JS Search -->
<script>
const currentUser = "{{ username }}";
const searchInput = document.querySelector('.search-bar input');
const newMatchList = document.getElementById('new-match-list');

searchInput.addEventListener('input', function() {
  const query = this.value.trim().toLowerCase();
  const items = newMatchList.querySelectorAll('.chat-item');

  items.forEach(item => {
    const name = item.querySelector('h4').innerText.toLowerCase();
    const email = item.querySelector('p').innerText.toLowerCase();
    item.style.display = name.includes(query) || email.includes(query) ? 'flex' : 'none';
  });
});
</script>

</body>
</html>
